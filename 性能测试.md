## 性能测试
1. 负载测试
2. 压力测试
3. 容量测试
4. 配置测试

### 团队支持
1. 市场

2. DBA

3. 运维

4. 开发

5. 测试

6. 客户

7. ... ...

### 性能测试流程
1. 分析
- 业务理解
- 需求分析
- 评估工作
2. 设计
- 模型
- 方案
- 脚本
3. 实现
- 脚本开发
- 环境
- 数据
4. 执行
- 运行测试
- 分析结果
- 出报告

### Locust特点
1. 简单易学，基于python脚本
2. 开源免费
3. 分布式执行，配置主从服务器执行
4. 基于事件驱动。与其他工具使用线程和进程来模拟用户，locust借助了gevent库对携程的支持，可以达到更高数量级的并发。
5. 不支持监控被测机，需要配合其他工具的辅助。

### 实现登录脚本
1. 分析请求
2. 实现脚本
3. 优化

### 指标体系
1. 响应时间：
- 反应系统处理效率指标，从开始到完成某项工作所需时间的度量，响应时间通常随负载增加而增加
2. 吞吐量
- 反应系统处理能力指标，指单位时间内完成工作的度量，可以从客户端或服务器端视角两方面来进行评估
3. 事务处理能力
- 一是该笔业务的响应时间，二是业务成功率，三是处理的速率

4. 资源的利用率
- cpu使用率，cpu队列长度，可用内存数，页交换频率，磁盘使用率，网络带宽，线程池消耗，连接池消耗
5. 其他： 数据库丶JVM丶Tomcat

### 监控windows系统指标
1. 管理工具-》 性能监视器 -》 用户定义 - 》 新建“数据收集器集” -》 下一步。
2. 点击 “数据收集器集”， 右侧右键选择 “performance Counter” 条目上右键点击“属性” 设置计数器丶日志格式丶间隔时间。
3. 右键点击 “数据收集器”， 在停止条件中设置持续时间不限制。
4. 点击开始，运行后查看结果

首先可以查看windows自带的性能监控，这个不太适用
###  实现业务请求
1. 实现查看商品的请求
2. 实现查看会员的请求
3. 将前面两个请求的响应所需要的数据取回来
4. 构造销售出库的请求

  问题1：
  1. 关于cookies， locust中自动帮我们管理cookies，不用我们进行管理
  2. self.client 会加到统计中去，如果不想加，自己写原生的requests内容；（假如第二个任务行为对象函数，调用了第一个行为对象，第一个也有self.client，那么就会进行默认的统计。）


可以去优化自己写的业务脚本，然后做监控



### 利用Python监控系统资源
- Psutil是一个基于python的跨平台的监控管理模块，它提供了非常方便的API，不但可以获取系统的CPU丶内存丶磁盘等资源，还可以获取进程信息，可以直接通过命令 “pip install psutil” 进行快速安装


**脚本monitor.py可以进行查看监控的具体参数**

```
import psutil
import time

'''
    cpu性能监控脚本
'''
print(" Cpu使用率  内存使用率   C盘使用率")
delay = 3
while True:
    # 监控cpu数量
    # print(psutil.cpu_count())
    time.sleep(delay)
    # 监控cpu百分比
    print(str(psutil.cpu_percent()) + "%     " + str(psutil.virtual_memory().percent) + "%    " + \
          str(psutil.disk_usage("C:\\").percent) + "%   " )
```



### 用户数
1. 最佳用户数： 系统能够承受的最佳负载
2. 最大用户数： 指系统能够随着的最大负载
3. 在线用户数： 所有正在访问系统用户（不一定正在操作，而是说当前客户端与服务端的session会话仍然保持
4. 并发用户数： 同时对服务器产生请求的用户总数‘
5. 系统用户数： 系统额定的用户数量（设计容量），理论值；

#### 常见场景
1. 门型，极端咳咳的，一般做压力测试
2. 拱形场景， 压力逐渐升高，然后持续一段时间，一般做负载测试
3. 复杂场景的测试，分析更加有意义；

#### 开始测试，测试概要
1. 基准测试 ： 目的是验证环境和脚本获取基准值
2. 负载测试： 不同用户级别下运行， 目的是分析指标趋势分析性能问题定容
3. 稳定性测试： 运行时间大于12小时， 目的是验证稳定性
4. 压力测试： 每个业务单独测试，目的是验证失效点

### 测试报告
1. 测试背景
2. 测试目标
3. 测试范围
4. 测试数据
5. 测试结果
6. 测试结论
7. 系统风险


